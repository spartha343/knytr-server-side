### PATHAO INTEGRATION TESTING - ENHANCED WITH BATCH SYNC
### Use REST Client extension in VS Code

@baseUrl = http://localhost:5000/api/v1
@token = YOUR_TOKEN_HERE

### ============================================
### SYNC STATUS & PROGRESS
### ============================================

### Get Sync Progress (Check how many zones are synced)
GET {{baseUrl}}/pathao/sync-progress
Authorization: Bearer {{token}}

### ============================================
### TEST 1: Verify sync-locations worked
### ============================================

### Get all cities (should return 66 cities)
GET {{baseUrl}}/pathao/cities
Content-Type: application/json

### ============================================
### TEST 2: Get Zones for a specific city
### ============================================

### Get zones for city_id 1 (Dhaka)
GET {{baseUrl}}/pathao/zones/1
Content-Type: application/json

### ============================================
### TEST 3: Get Areas for a specific zone
### ============================================

### Get areas for a zone (use a zone_id from previous response)
GET {{baseUrl}}/pathao/areas/1
Content-Type: application/json

### ============================================
### TEST 4: Register Store (VENDOR/ADMIN)
### ============================================

### Register a store with Pathao
POST {{baseUrl}}/pathao/stores/register
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "branchId": "YOUR_BRANCH_ID",
  "cityId": 1,
  "zoneId": 1,
  "areaId": 1,
  "contactName": "Test Store Manager",
  "contactNumber": "01712345678"
}

### ============================================
### TEST 5: Get All Stores (VENDOR/ADMIN)
### ============================================

### Get all registered Pathao stores
GET {{baseUrl}}/pathao/stores
Authorization: Bearer {{token}}

### ============================================
### TEST 6: Get All Deliveries (VENDOR/ADMIN)
### ============================================

### Get all Pathao deliveries
GET {{baseUrl}}/pathao/deliveries
Authorization: Bearer {{token}}

### ============================================
### TEST 7: Manual Delivery Creation (VENDOR/ADMIN)
### ============================================

### Create delivery for a specific order
POST {{baseUrl}}/pathao/orders/YOUR_ORDER_ID/create-delivery
Authorization: Bearer {{token}}
Content-Type: application/json

### ============================================
### TEST 8: Fetch Delivery Status (VENDOR/ADMIN)
### ============================================

### Fetch delivery status from Pathao API
GET {{baseUrl}}/pathao/deliveries/CONSIGNMENT_ID/status
Authorization: Bearer {{token}}

### ============================================
### TEST 9: Get Delivery by ID (VENDOR/ADMIN)
### ============================================

### Get specific delivery details
GET {{baseUrl}}/pathao/deliveries/DELIVERY_ID
Authorization: Bearer {{token}}

### ============================================
### TEST 10: Retry Failed Delivery (VENDOR/ADMIN)
### ============================================

### Retry a failed delivery
POST {{baseUrl}}/pathao/deliveries/DELIVERY_ID/retry
Authorization: Bearer {{token}}
Content-Type: application/json

### ============================================
### TEST 11: Webhook Simulation
### ============================================

### Simulate Pathao webhook callback
POST {{baseUrl}}/pathao/webhook
Content-Type: application/json
X-Pathao-Signature: test_signature

{
  "consignment_id": "TEST123456",
  "merchant_order_id": "ORD-001",
  "status": "Picked up",
  "timestamp": "2026-02-16T10:30:00Z"
}

### ============================================
### BATCH SYNC ENDPOINTS (ADMIN ONLY)
### ============================================

### TEST 12: Sync Locations - Partial (Default: 3 zones)
POST {{baseUrl}}/pathao/sync-locations
Authorization: Bearer {{token}}

### TEST 13: Sync Locations - Custom Zone Limit (e.g., 10 zones)
POST {{baseUrl}}/pathao/sync-locations?maxZones=10
Authorization: Bearer {{token}}

### TEST 14: Batch Sync Areas - First Batch (50 zones)
### RECOMMENDED: Use this to sync all zones in batches
POST {{baseUrl}}/pathao/sync-areas-batch?batchSize=50
Authorization: Bearer {{token}}

### TEST 15: Batch Sync Areas - Resume from Last Zone
### Replace startFromZoneId with lastProcessedZoneId from previous response
POST {{baseUrl}}/pathao/sync-areas-batch?startFromZoneId=0&batchSize=50
Authorization: Bearer {{token}}

### TEST 16: Batch Sync Areas - Fast Sync (Reduced delay)
### Use this for faster sync but higher risk of rate limits
POST {{baseUrl}}/pathao/sync-areas-batch?batchSize=100&delayBetweenZones=2000
Authorization: Bearer {{token}}

### TEST 17: Full Sync - ALL ZONES (⚠️ WARNING: Takes 45+ minutes!)
### Only use this if you want to sync everything at once
# POST {{baseUrl}}/pathao/sync-locations?fullSync=true
# Authorization: Bearer {{token}}

### ============================================
### RECOMMENDED BATCH SYNC WORKFLOW
### ============================================

### Step 1: Check current progress
# GET {{baseUrl}}/pathao/sync-progress

### Step 2: Run first batch (50 zones)
# POST {{baseUrl}}/pathao/sync-areas-batch?batchSize=50

### Step 3: Check progress again
# GET {{baseUrl}}/pathao/sync-progress

### Step 4: Continue with next batch using lastProcessedZoneId
# POST {{baseUrl}}/pathao/sync-areas-batch?startFromZoneId=XXX&batchSize=50

### Step 5: Repeat until syncPercentage reaches 100%
